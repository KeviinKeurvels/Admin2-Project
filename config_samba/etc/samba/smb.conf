#======================= Global Settings =====================================
[global]

# workgroup = NT-Domain-Name or Workgroup-Name, eg: MIDEARTH
   workgroup = MONGROUPE

# server string is the equivalent of the NT Description field
   server string = Serveur Samba pour le reseau l1-3.ephec-ti.be (hostname : %h, version : %v)

# Server role. Defines in which mode Samba will operate. Possible
# values are "standalone server", "member server", "classic primary
# domain controller", "classic backup domain controller", "active
# directory domain controller".
#
# Most people will want "standalone sever" or "member server".
# Running as "active directory domain controller" will require first
# running "samba-tool domain provision" to wipe databases and create a
# new domain.
   server role = standalone server

# This option is important for security. It allows you to restrict
# connections to machines which are on your local network. The
# following example restricts access to two C class networks and
# the "loopback" interface. For more examples of the syntax see
# the smb.conf man page
   hosts allow = 172.19.0.0/16 127.0.0.1


# this tells Samba to use a separate log file for each machine
# that connects
# %m -> represente le nom NetBIOS. Pose un probleme ?
   log file = /usr/local/samba/var/log.%m

# Put a capping on the size of the log files (in Kb).
   max log size = 50

# DNS Proxy - tells Samba whether or not to try to resolve NetBIOS names
# via DNS nslookups. The default is NO.
   dns proxy = no 

# These scripts are used on a domain controller or stand-alone 
# machine to add or delete corresponding unix accounts
;  add user script = /usr/sbin/useradd %u
;  add group script = /usr/sbin/groupadd %g
;  add machine script = /usr/sbin/adduser -n -g machines -c Machine -d /dev/null -s /bin/false %u
;  delete user script = /usr/sbin/userdel %u
;  delete user from group script = /usr/sbin/deluser %u %g
;  delete group script = /usr/sbin/groupdel %g


# Securite user -> de base, on est pas oblige de l'ecrire
security = user

# Limite le nombre de connections
max connections = 3

# Limite le nombre de processus samba qui tournent, epeche la surcharge
Max smbd processes = 100

#============================ Share Definitions ==============================
[homes]
# On doit creer les utilisateurs samba (et leur donner un mot de passe) + creer les repertoires correspondant 
#sudo useradd -s /bin/true user-name
#sudo smbpasswd -a user-name
#sudo mkdir /shares/personnels/user-name
#sudo chown user-name:user-name /shares/personnels/user-name
#sudo chmod 700 /shares/personnels/user-name

comment = Dossier personnels des users dans le cloud local
path = /shares/personnels/%S
valid users = %S
read only = No
writeable = yes
# Droits: seulement celui qui a cree les fichiers et repertoires peut les voir, le modifier et les executer
create mask = 0700
directory mask = 0700

force create mode = 0000
force directory mode = 0000
# Ce share n'est pas visible dans la liste des shares disponibles. On doit demander ce share specifiquement: smb://server/user-name 
browseable = No


[partages]
# Dosier partage test
path = /shares/partages

public = no
read only = no
writeable = yes

# Tous les utilisateurs sont consideres comme etant l'utilisateur USER et faisant partie du groupe GROUP par le systeme. 
# Mettre en place si on veut utiliser le meme user et le meme mot de passe pour acceder au partage. Attention il faut creer le user et le groupe.
;force user = USER
;force group = GROUP

# On fait un AND logique entre les droits de base et les masques. Ces masques supprimes les droits pas présent ici. 
# create -> pour les fichiers directory -> pour les répertoires
create mask = 0700
directory mask = 0700


# On fait un OR logique entre les droits après le AND (juste au dessus) et ces paramètres. Ils forcent certains droits.
force create mode = 0000
force directory mode = 0000



security mask = 0777
force security mode = 0777

directory security mask = 0777
force directory security mode = 0777


guest ok = no
# si guest ok = yes, on peut faire en sorte que tout le monde soit considere comme un invite.
 
# Que faire lorsqu'une requete de login de correspond pas avec un utilisateur UNIX (https://www.samba.org/samba/docs/current/man-html/smb.conf.5.html#MAPTOGUEST)
map to guest = Never
; map to guest = Bad User
; map to guest = Bad Password
; map to guest = Bad Uid


# Mettre d'autres partages suite a une analyse poussee